# Проект 251029_GKSTCPLK-1831

## Основная информация

**Название задачи:** Разработать АРМ по промежуточному композиту для УС по партиям ТС  
**Путь:** src/projects/configuration/251029_GKSTCPLK-1831  
**Дата создания:** 2025-10-29  
**Статус:** В разработке

## Описание задачи

Разработка АРМ (автоматизированного рабочего места) для работы с промежуточными композитными пробами в рамках усиленного контроля качества по партиям транспортных средств.

### Основная функциональность

1. **Обработка гкс_АРМПромежуточныйКомпозит** (вкладка СтраницаУсиленныйКонтроль):
   - Вывод состояния регистрации (срез последних по РС_СостоянияРегистрации)
   - Подбор данных из РС Показатели качества усиленного контроля с назначением "промежуточный композит"
   - Связь с РС гкс_СоставГруппТранспорта для получения информации по группам ТС
   - Фильтрация по состоянию качества (пустое / отбор проб)
   - Режим "показать все" для отображения всех данных

2. **Интерактивная работа с таблицей анализов:**
   - Автоматическое выделение строк с одинаковой группой ТС и показателем
   - Валидация состояния качества перед открытием формы
   - Предотвращение повторного создания анализов

3. **Формирование композитных проб:**
   - Передача показателей по выделенным строкам для формирования номера пробы
   - Создание лабораторных анализов
   - Исключение регистраций с качеством "не принято" из композитных проб
   - Запись состояния "НеПринятоВходнойКонтроль" для непринятых регистраций

4. **Особенности лабораторных анализов:**
   - Для типа документа "Регистрации Формирование номера проб"
   - Поиск анализов/значений по регистрациям, входящим в формирование номера пробы

## Структура объектов конфигурации

### Статистика
- **Справочники (гкс_*):** 74
- **Документы (гкс_*):** 48  
- **Регистры сведений (гкс_*):** 126
- **Всего пользовательских объектов:** 445

### Ключевые объекты для задачи

#### Обработки (DataProcessors)
- `гкс_АРМПромежуточныйКомпозит` - основная обработка
- `гкс_АРМКомпозитныеПробы` - работа с композитными пробами
- `гкс_АРМПриемкаПоКачеству` - приемка по качеству
- `гкс_АРМКПП` - АРМ контрольно-пропускного пункта

#### Документы (Documents)
- `гкс_ЛабораторныйАнализ` - регистрация лабораторных анализов
- `гкс_ФормированиеНомераПробы` - формирование номеров проб (предположительно)
- `гкс_Взвешивание` - взвешивание продукции
- `гкс_ВъездНаКПП`, `гкс_ВыездНаКПП` - контроль въезда/выезда
- `гкс_ЗаданияНаПроверкуКачества` - задания на проверку

#### Регистры сведений (InformationRegisters)
- `гкс_ПоказателиУсиленногоКонтроляПоРегистрации` - **КЛЮЧЕВОЙ** - показатели качества УК
- `гкс_СоставГруппТранспорта` - состав групп транспорта
- `гкс_НастройкиУсиленногоКонтроляКачества` - настройки УК качества
- `гкс_ЗаданияНаПроверкуКачества` - задания на проверку качества
- `гкс_КомментарииКСтатусуКачествоНеПринято` - комментарии к статусу "не принято"
- `гкс_МинимальныеПоказателиКачестваПриемки` - минимальные показатели
- `гкс_СегментацияКачестваНоменклатуры` - сегментация качества

### Типы объектов метаданных

Конфигурация включает все стандартные типы объектов 1С:
- AccumulationRegisters (регистры накопления)
- Catalogs (справочники)
- ChartsOfCharacteristicTypes (планы видов характеристик)
- CommonModules (общие модули)
- Constants (константы)
- DataProcessors (обработки)
- Documents (документы)
- Enums (перечисления)
- EventSubscriptions (подписки на события)
- ExchangePlans (планы обмена)
- FilterCriteria (критерии отбора)
- FunctionalOptions (функциональные опции)
- HTTPServices (HTTP-сервисы)
- InformationRegisters (регистры сведений)
- Reports (отчеты)
- Roles (роли)
- ScheduledJobs (регламентные задания)
- Subsystems (подсистемы)
- WebServices (веб-сервисы)
- XDTOPackages (XDTO-пакеты)

## Бизнес-логика

### Состояния качества
- **Пустое** - начальное состояние, требует обработки
- **Отбор проб** - пробы отобраны, требуется анализ
- **НеПринятоВходнойКонтроль** - качество не принято на входном контроле
- **Анализы выполнены** - анализы завершены (повторное создание невозможно)

### Рабочий процесс
1. Регистрация партии ТС
2. Определение группы ТС
3. Назначение показателей усиленного контроля
4. Отбор проб (композитная проба)
5. Формирование номера пробы
6. Создание лабораторного анализа
7. Получение результатов анализа
8. Принятие решения по качеству

## Технические особенности

- Префикс объектов: `гкс_` (ГКС - видимо, аббревиатура организации)
- Язык разработки: BSL (1C:Enterprise Built-in Language)
- Кодировка: UTF-8 с кириллицей
- Используется клиент-серверная архитектура 1С

## Связанные компоненты

- РС_СостоянияРегистрации - регистр состояний регистрации
- Механизм формирования номеров проб
- Интеграция с ЛИМС (лабораторной информационной системой)

## Документация

Файл документации: `docs/251029_GKSTCPLK-1831 Разработать АРМ по промежуточному композиту для УС по партиям ТС.md`

## Рекомендации для разработки

1. Использовать типизацию для всех параметров процедур и функций
2. Применять стандарты разработки 1С
3. Обрабатывать исключения через Попытка...Исключение
4. Использовать транзакции для целостности данных
5. Оптимизировать запросы (индексы, виртуальные таблицы)
6. Документировать код комментариями на русском языке

## Зависимости от других проектов

Проект является частью большой системы управления качеством продукции и связан с:
- Системой приемки по качеству
- Системой управления транспортом (КПП)
- Лабораторной системой
- Системой взвешивания
