# Sequential Thinking MCP - Тестирование и настройка

## Описание сервера

**Sequential Thinking MCP** - это сервер Model Context Protocol, предназначенный для структурированного пошагового решения сложных задач с возможностью динамической ревизии и ветвления мыслительного процесса.

## Основные возможности

### 1. Пошаговое мышление
- Разбивка сложных проблем на управляемые шаги
- Каждая "мысль" (thought) является отдельным шагом анализа
- Поддержка итеративного процесса мышления

### 2. Динамическая ревизия
- Возможность пересмотра предыдущих шагов
- Корректировка курса решения по мере получения новой информации
- Параметр `revisedThought` для обновления предыдущих выводов

### 3. Ветвление логики
- Создание альтернативных путей решения
- Параметры `branchFromThought` и `branchId` для управления ветвлением
- Исследование нескольких гипотез параллельно

## Конфигурация в .mcp.json

```json
"sequential-thinking": {
    "type": "stdio",
    "command": "npx",
    "args": [
        "-y",
        "@modelcontextprotocol/server-sequential-thinking"
    ],
    "env": {
        "DISABLE_THINKING_LOG": "false"  // Опционально: отключить логирование мыслей
    }
}
```

## Основной инструмент: sequential_thinking

### Параметры инструмента:

```typescript
{
    thought: string,              // Текущий шаг мышления
    nextThoughtNeeded: boolean,   // Нужен ли следующий шаг
    thoughtNumber: number,        // Номер текущей мысли
    totalThoughts: number,        // Общее предполагаемое количество мыслей
    
    // Опциональные параметры для ревизии и ветвления:
    revisedThought?: number,      // Номер мысли для ревизии
    branchFromThought?: number,   // Номер мысли для ветвления
    branchId?: string            // Идентификатор ветки
}
```

## Примеры использования

### Пример 1: Простой анализ проблемы

```javascript
// Шаг 1: Определение проблемы
sequential_thinking({
    thought: "Нужно оптимизировать производительность приложения. Начну с анализа текущих узких мест.",
    nextThoughtNeeded: true,
    thoughtNumber: 1,
    totalThoughts: 5
})

// Шаг 2: Анализ метрик
sequential_thinking({
    thought: "По результатам профилирования, основные проблемы: медленные SQL запросы (45%), неэффективное кеширование (30%), избыточные API вызовы (25%).",
    nextThoughtNeeded: true,
    thoughtNumber: 2,
    totalThoughts: 5
})

// Шаг 3: Приоритизация
sequential_thinking({
    thought: "Начну с оптимизации SQL запросов, так как это даст максимальный эффект. Нужно добавить индексы и переписать N+1 запросы.",
    nextThoughtNeeded: true,
    thoughtNumber: 3,
    totalThoughts: 5
})
```

### Пример 2: Ревизия предыдущей мысли

```javascript
sequential_thinking({
    thought: "После дополнительного анализа выяснилось, что проблема с кешированием критичнее. Изменю приоритеты.",
    nextThoughtNeeded: true,
    thoughtNumber: 4,
    totalThoughts: 6,
    revisedThought: 3  // Пересматриваем мысль №3
})
```

### Пример 3: Ветвление для альтернативных решений

```javascript
// Основная ветка
sequential_thinking({
    thought: "Рассмотрю вариант с полным рефакторингом архитектуры.",
    nextThoughtNeeded: true,
    thoughtNumber: 5,
    totalThoughts: 8,
    branchFromThought: 3,
    branchId: "refactoring-branch"
})

// Альтернативная ветка
sequential_thinking({
    thought: "Альтернативный подход: точечные оптимизации без изменения архитектуры.",
    nextThoughtNeeded: true,
    thoughtNumber: 5,
    totalThoughts: 7,
    branchFromThought: 3,
    branchId: "optimization-branch"
})
```

## Идеальные сценарии использования

1. **Архитектурное проектирование**
   - Пошаговая разработка архитектуры системы
   - Оценка альтернативных подходов
   - Документирование процесса принятия решений

2. **Отладка сложных проблем**
   - Систематический анализ багов
   - Формирование и проверка гипотез
   - Отслеживание попыток решения

3. **Планирование проектов**
   - Декомпозиция задач
   - Оценка рисков и альтернатив
   - Итеративное уточнение плана

4. **Анализ требований**
   - Пошаговое уточнение требований
   - Выявление противоречий
   - Документирование логики решений

## Тестовые сценарии

### Тест 1: Базовая последовательность мыслей
```bash
# В Claude Code после перезапуска:
# Используйте sequential_thinking для решения задачи оптимизации базы данных
```

### Тест 2: Ревизия и корректировка
```bash
# Начните анализ, затем пересмотрите второй шаг на основе новых данных
```

### Тест 3: Параллельные ветки решения
```bash
# Создайте две альтернативные ветки для решения проблемы производительности
```

## Интеграция с другими MCP серверами

Sequential Thinking отлично работает в связке с:
- **Task Master**: для декомпозиции и планирования задач
- **GitHub MCP**: для анализа кода и архитектуры
- **Database MCP**: для оптимизации запросов

## Лучшие практики

1. **Оценивайте totalThoughts реалистично** - лучше недооценить и добавить шаги, чем переоценить
2. **Используйте ревизии для корректировок** - не бойтесь пересматривать предыдущие выводы
3. **Документируйте ветвления** - четко обозначайте цель каждой ветки
4. **Сохраняйте контекст** - каждая мысль должна быть понятна сама по себе

## Отладка и устранение проблем

### Проблема: Сервер не запускается
**Решение:**
```bash
# Проверьте установку
npm list -g @modelcontextprotocol/server-sequential-thinking

# Переустановите если нужно
npm uninstall -g @modelcontextprotocol/server-sequential-thinking
npm install -g @modelcontextprotocol/server-sequential-thinking
```

### Проблема: Нет вывода от сервера
**Решение:**
- Проверьте переменную окружения `DISABLE_THINKING_LOG`
- Убедитесь, что она установлена в `"false"` или не задана

### Проблема: Потеря контекста между мыслями
**Решение:**
- Используйте более подробные описания в параметре `thought`
- Ссылайтесь на номера предыдущих мыслей явно

## Команды для проверки

```bash
# Проверка установки
which npx
npx @modelcontextprotocol/server-sequential-thinking --version

# Тест запуска (будет ждать stdio ввода)
echo '{"jsonrpc":"2.0","method":"tools/list","id":1}' | npx @modelcontextprotocol/server-sequential-thinking

# Проверка в Claude Code
# После перезапуска Claude Code должен видеть sequential_thinking в списке доступных инструментов
```

---

**Создано:** 10.09.2025
**Статус:** ✅ Установлен и настроен
**Версия:** @modelcontextprotocol/server-sequential-thinking последняя