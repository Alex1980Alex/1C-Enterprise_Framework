# Redis Caching Guide
# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞

**–î–∞—Ç–∞**: 2025-11-03
**–í–µ—Ä—Å–∏—è**: 1.0
**–°—Ç–∞—Ç—É—Å**: ‚úÖ READY

---

## –û–±–∑–æ—Ä

BSL Code Search API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ** –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ —á–µ—Ä–µ–∑ Redis –¥–ª—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

- **–°–∫–æ—Ä–æ—Å—Ç—å**: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∑–∞ ~10-50ms –≤–º–µ—Å—Ç–æ ~7500ms
- **–ù–∞–≥—Ä—É–∑–∫–∞**: –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ Qdrant –∏ Ollama –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º QPS
- **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫–µ—à–∞ –≤ —Ä–µ–∂–∏–º–µ pass-through

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

1. **–ë–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
   - –ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   - API —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ
   - –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Qdrant + Ollama

2. **–° –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º**:
   - –ï—Å–ª–∏ Redis –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   - –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∫–µ—à
   - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫–µ—à–∞
   - TTL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1 —á–∞—Å

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis

### Windows

```powershell
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Chocolatey
choco install redis-64

# –í–∞—Ä–∏–∞–Ω—Ç 2: –°–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—É—é —Å–±–æ—Ä–∫—É
# https://github.com/microsoftarchive/redis/releases
# –°–∫–∞—á–∞—Ç—å Redis-x64-3.2.100.msi –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
```

**–ó–∞–ø—É—Å–∫ Redis –Ω–∞ Windows**:
```powershell
# –ó–∞–ø—É—Å–∫ –∫–∞–∫ —Å–ª—É–∂–±–∞ (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —á–µ—Ä–µ–∑ MSI)
# Redis –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
redis-server
```

### Linux

```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install redis-server

# CentOS/RHEL
sudo yum install redis

# –ó–∞–ø—É—Å–∫
sudo systemctl start redis
sudo systemctl enable redis  # –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
```

### MacOS

```bash
# Homebrew
brew install redis

# –ó–∞–ø—É—Å–∫
brew services start redis
```

### Docker

```bash
# –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫
docker run -d -p 6379:6379 --name redis redis:latest

# –° –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö
docker run -d -p 6379:6379 \
  -v redis-data:/data \
  --name redis \
  redis:latest redis-server --appendonly yes

# –° –ø–∞—Ä–æ–ª–µ–º
docker run -d -p 6379:6379 \
  --name redis \
  redis:latest redis-server --requirepass your-password
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
redis-cli ping
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: PONG

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏
redis-cli --version

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
redis-cli monitor
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Redis

```bash
cd ai-memory-system
pip install redis
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª `.env`:

```bash
# Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_TTL=3600

# –ï—Å–ª–∏ Redis —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–æ–ª—å
# REDIS_PASSWORD=your-redis-password
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ API

```bash
cd ai-memory-system
python -m uvicorn api.main:app --host 0.0.0.0 --port 8000 --reload
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** –≤ –ª–æ–≥–∞—Ö:
```
‚úÖ Redis –∫–µ—à: –í–ö–õ–Æ–ß–ï–ù (TTL: 3600s)
```

–ò–ª–∏ –µ—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:
```
‚ö†Ô∏è  Redis –∫–µ—à: –û–¢–ö–õ–Æ–ß–ï–ù (—Ä–∞–±–æ—Ç–∞ –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è)
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–∏—Å–∫–∞:

```python
import requests

# –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å - –∏–¥–µ—Ç –≤ Qdrant (~7500ms)
response = requests.post(
    "http://localhost:8000/api/v1/search",
    json={
        "query": "—Ä–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏",
        "top_k": 5
    }
)

# –í—Ç–æ—Ä–æ–π —Ç–∞–∫–æ–π –∂–µ –∑–∞–ø—Ä–æ—Å - –∏–∑ –∫–µ—à–∞ (~10-50ms)
response = requests.post(
    "http://localhost:8000/api/v1/search",
    json={
        "query": "—Ä–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏",
        "top_k": 5
    }
)
```

### –ö–ª—é—á–∏ –∫–µ—à–∞

–ö–µ—à –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SHA-256 —Ö–µ—à –æ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏:
- –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (`query`)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (`top_k`, `score_threshold`)

**–ü—Ä–∏–º–µ—Ä**:
```python
# –≠—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å –†–ê–ó–ù–´–ï –∫–ª—é—á–∏ –∫–µ—à–∞:
{"query": "–¥–æ–∫—É–º–µ–Ω—Ç—ã", "top_k": 5}   # –ö–ª—é—á 1
{"query": "–¥–æ–∫—É–º–µ–Ω—Ç—ã", "top_k": 10}  # –ö–ª—é—á 2 (—Ä–∞–∑–Ω—ã–π top_k)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–µ—à–∞

```bash
# GET –∑–∞–ø—Ä–æ—Å
curl http://localhost:8000/api/v1/cache/stats
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
```json
{
    "enabled": true,
    "cached_queries": 42,
    "ttl_seconds": 3600,
    "keyspace_hits": 156,
    "keyspace_misses": 42,
    "total_commands_processed": 512
}
```

### –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞

```bash
# DELETE –∑–∞–ø—Ä–æ—Å
curl -X DELETE http://localhost:8000/api/v1/cache/clear
```

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞**:
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–∏—Å–∫–∞
- –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ embeddings
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ API

–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º –∫–µ—à–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
# Cache HIT (–∏–∑ –∫–µ—à–∞)
üéØ Cache HIT: '—Ä–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏' (12.45ms)

# Cache MISS (–∏–¥–µ—Ç –≤ Qdrant)
üîç –ü–æ–∏—Å–∫: '–Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å'
‚úÖ –ù–∞–π–¥–µ–Ω–æ: 5 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞ 7543.21ms
üíæ Cached: –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å... (TTL: 3600s)
```

### Redis CLI –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–º–∞–Ω–¥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
redis-cli monitor

# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–ª—é—á–µ–π –ø–æ–∏—Å–∫–∞
redis-cli --scan --pattern "search:*"

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π
redis-cli DBSIZE

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Redis
redis-cli INFO

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
redis-cli INFO stats
```

### –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–µ—à–∞

```bash
# –ù–∞–π—Ç–∏ –∫–ª—é—á
redis-cli --scan --pattern "search:*" | head -1

# –£–¥–∞–ª–∏—Ç—å –∫–ª—é—á
redis-cli DEL search:abc123...
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TTL

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –∫–µ—à–∞

–í —Ñ–∞–π–ª–µ `.env`:

```bash
# 30 –º–∏–Ω—É—Ç
REDIS_TTL=1800

# 1 —á–∞—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
REDIS_TTL=3600

# 2 —á–∞—Å–∞
REDIS_TTL=7200

# 24 —á–∞—Å–∞
REDIS_TTL=86400
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ TTL

- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: 300-600 —Å–µ–∫—É–Ω–¥ (5-10 –º–∏–Ω—É—Ç)
- **Staging**: 1800 —Å–µ–∫—É–Ω–¥ (30 –º–∏–Ω—É—Ç)
- **Production**: 3600-7200 —Å–µ–∫—É–Ω–¥ (1-2 —á–∞—Å–∞)
- **–†–µ–¥–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 86400 —Å–µ–∫—É–Ω–¥ (24 —á–∞—Å–∞)

---

## Production —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–æ–ª—å Redis

```bash
# .env
REDIS_PASSWORD=strong-random-password
```

```bash
# redis.conf
requirepass strong-random-password
```

### 2. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ —Å–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø

```bash
# redis.conf
bind 127.0.0.1  # –¢–æ–ª—å–∫–æ localhost
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª:
```bash
# UFW (Ubuntu)
sudo ufw allow from 10.0.0.0/24 to any port 6379
```

### 3. –í–∫–ª—é—á–∏—Ç–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

```bash
# redis.conf

# RDB —Å–Ω–∞–ø—à–æ—Ç—ã
save 900 1       # 1 –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞ 15 –º–∏–Ω—É—Ç
save 300 10      # 10 –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞ 5 –º–∏–Ω—É—Ç
save 60 10000    # 10000 –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞ 1 –º–∏–Ω—É—Ç—É

# AOF (Append Only File)
appendonly yes
appendfsync everysec
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

- **Redis Insight**: GUI –¥–ª—è Redis
- **RedisMonitor**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫
- **Prometheus + Grafana**: –î–ª—è production

–ü—Ä–∏–º–µ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- Keyspace hits/misses ratio
- Memory usage
- Commands per second
- Evicted keys

### 5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É eviction

```bash
# redis.conf

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å
maxmemory 256mb

# –ü–æ–ª–∏—Ç–∏–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
maxmemory-policy allkeys-lru  # LRU –¥–ª—è –≤—Å–µ—Ö –∫–ª—é—á–µ–π
```

**–ü–æ–ª–∏—Ç–∏–∫–∏ eviction**:
- `noeviction`: –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- `allkeys-lru`: –£–¥–∞–ª—è–µ—Ç —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–ª—é—á–∏
- `volatile-lru`: –£–¥–∞–ª—è–µ—Ç —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–ª—é—á–∏ —Å TTL
- `allkeys-random`: –°–ª—É—á–∞–π–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- `volatile-ttl`: –£–¥–∞–ª—è–µ—Ç –∫–ª—é—á–∏ —Å –±–ª–∏–∂–∞–π—à–∏–º TTL

### 6. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

```bash
# –ù–∞ slave —Å–µ—Ä–≤–µ—Ä–µ –≤ redis.conf
replicaof master-redis-host 6379
masterauth master-password
```

---

## FAQ

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –±–µ–∑ Redis?**
A: –î–∞, API —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ pass-through. Redis –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π.

**Q: –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –≤–∑—è—Ç –∏–∑ –∫–µ—à–∞?**
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API - –ø—Ä–∏ cache hit –±—É–¥–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ `üéØ Cache HIT`. –¢–∞–∫–∂–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –±—É–¥–µ—Ç ~10-50ms –≤–º–µ—Å—Ç–æ ~7500ms.

**Q: –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ—Å–ª–∏ Redis —É–ø–∞–ª –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã?**
A: API –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–µ–∂–∏–º–µ –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è. –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**Q: –ù—É–∂–Ω–æ –ª–∏ –æ—á–∏—â–∞—Ç—å –∫–µ—à –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏?**
A: –î–∞, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö:
```bash
curl -X DELETE http://localhost:8000/api/v1/cache/clear
```

**Q: –°–∫–æ–ª—å–∫–æ –ø–∞–º—è—Ç–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –∫–µ—à?**
A: –ü—Ä–∏–º–µ—Ä–Ω–æ 1-5 KB –Ω–∞ –æ–¥–∏–Ω –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å. –î–ª—è 1000 –∑–∞–ø—Ä–æ—Å–æ–≤: ~1-5 MB. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:
```bash
redis-cli INFO memory
```

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ TTL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤?**
A: –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–π TTL –∏–∑ `.env`. –î–ª—è —Ä–∞–∑–Ω—ã—Ö TTL –Ω—É–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `api/cache.py`.

**Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ Redis Cluster?**
A: –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å single-instance Redis. –î–ª—è Redis Cluster —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `api/cache.py`.

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å/–±–µ–∑ –∫–µ—à–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë–µ–∑ –∫–µ—à–∞ | –° –∫–µ—à–µ–º (HIT) |
|---------|----------|---------------|
| –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ | 7000-8000ms | 10-50ms |
| –£—Å–∫–æ—Ä–µ–Ω–∏–µ | 1x | 140-700x |
| –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Qdrant | 100% | ~5-10% |
| –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Ollama | 100% | 0% |
| –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å | ~8 req/min | ~120-600 req/min |

### –ü—Ä–∏–º–µ—Ä—ã real-world –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ë–µ–∑ –∫–µ—à–∞ (cold)**:
```
Query: "–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"
Time: 7543ms
```

**–° –∫–µ—à–µ–º (warm)**:
```
Query: "–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤" (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π)
Time: 12ms (üéØ Cache HIT)
Speedup: 628x
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: Redis –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã**:
```
‚ö†Ô∏è  Redis unavailable: Error 10061. Caching disabled.
```

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—â–µ–Ω –ª–∏ Redis
redis-cli ping

# –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç—å
redis-server

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
netstat -an | findstr 6379  # Windows
netstat -an | grep 6379     # Linux/Mac
```

### –ü—Ä–æ–±–ª–µ–º–∞: Connection timeout

**–°–∏–º–ø—Ç–æ–º—ã**:
```
‚ö†Ô∏è  Redis unavailable: Timeout. Caching disabled.
```

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å timeout –≤ api/cache.py –∏–ª–∏
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ping redis-host

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π—Ä–≤–æ–ª
telnet redis-host 6379
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–µ—à –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ Redis CLI
redis-cli
> KEYS search:*
> FLUSHDB  # –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –ë–î
> FLUSHALL # –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ë–î

# –ò–ª–∏ —á–µ—Ä–µ–∑ API
curl -X DELETE http://localhost:8000/api/v1/cache/clear
```

### –ü—Ä–æ–±–ª–µ–º–∞: Out of memory

**–°–∏–º–ø—Ç–æ–º—ã**:
```
Redis: OOM command not allowed when used memory > 'maxmemory'
```

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
redis-cli INFO memory

# –£–≤–µ–ª–∏—á–∏—Ç—å maxmemory –≤ redis.conf
maxmemory 512mb

# –ò–ª–∏ –≤–∫–ª—é—á–∏—Ç—å eviction
maxmemory-policy allkeys-lru
```

---

## –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ü—Ä–µ—Ñ–∏–∫—Å –∫–µ—à–∞ –ø–æ –≤–µ—Ä—Å–∏–∏ –∏–Ω–¥–µ–∫—Å–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
2. **–†–∞–∑–Ω—ã–µ TTL –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏
3. **Cache warming** - –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. **Redis Cluster** - –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
5. **Bloom filters** - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤ –∫–µ—à–µ
6. **Compression** - —Å–∂–∞—Ç–∏–µ –±–æ–ª—å—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

**–ê–≤—Ç–æ—Ä**: Claude Code AI
**–î–∞—Ç–∞**: 2025-11-03
**–ü—Ä–æ–µ–∫—Ç**: 1C-Enterprise_Framework / ai-memory-system

**–°–º. —Ç–∞–∫–∂–µ**:
- [AUTHENTICATION_GUIDE.md](AUTHENTICATION_GUIDE.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [API Documentation](../api/) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- [.env.example](../.env.example) - –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
