# üî¥ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –ü–†–ê–í–ò–õ–û: AST-grep –¥–ª—è BSL —Ñ–∞–π–ª–æ–≤

> **–î–∞—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:** 2025-10-23
> **–°—Ç–∞—Ç—É—Å:** –ê–ö–¢–ò–í–ù–û–ï - –í–°–ï–ì–î–ê —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ–º—É –ø—Ä–∞–≤–∏–ª—É
> **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô ‚≠ê‚≠ê‚≠ê

---

## üìã –ü—Ä–∞–≤–∏–ª–æ

**–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π `mcp__ast-grep-mcp__ast_grep` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã BSL —Ñ–∞–π–ª–æ–≤**

**–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π `mcp__serena__get_symbols_overview` –∏–ª–∏ `mcp__serena__find_symbol` –∫–∞–∫ –ø–µ—Ä–≤—ã–π –≤—ã–±–æ—Ä –¥–ª—è BSL**

---

## ‚ùì –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –∫—Ä–∏—Ç–∏—á–Ω–æ?

1. **BSL Language Server –Ω–µ –Ω–∞–¥–µ–∂–µ–Ω:**
   - –ß–∞—Å—Ç–æ –ù–ï –≤–∏–¥–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
   - –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å `|` –ª–æ–º–∞—é—Ç –ø–∞—Ä—Å–∏–Ω–≥
   - –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Serena

2. **AST-grep –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   - ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç Language Server
   - ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
   - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ BSL —Ñ–∞–π–ª–∞–º–∏
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö

3. **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:**
   ```
   –ü—Ä–æ–µ–∫—Ç: 251014_GKSTCPLK-1788/ObjectModule.bsl

   Serena:   ‚ùå –ù–∞—à–ª–∞ —Ç–æ–ª—å–∫–æ 2 —Ä–µ–≥–∏–æ–Ω–∞ (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
   AST-grep: ‚úÖ –ù–∞—à–ª–∞ 5 —Ñ—É–Ω–∫—Ü–∏–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   ```

---

## üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ù–∞–π—Ç–∏ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –º–æ–¥—É–ª–µ:

```javascript
mcp__ast-grep-mcp__ast_grep({
  pattern: "–§—É–Ω–∫—Ü–∏—è $NAME($$$ARGS)",
  path: "src/DataProcessors/–≥–∫—Å_–ê–†–ú–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π–ö–æ–º–ø–æ–∑–∏—Ç/Ext/ObjectModule.bsl",
  bsl_type: "functions"
})
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ù–∞–π—Ç–∏ –≤—Å–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã:

```javascript
mcp__ast-grep-mcp__ast_grep({
  pattern: "–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ $NAME($$$ARGS)",
  path: "src/DataProcessors/Module/Forms/–§–æ—Ä–º–∞/Ext/Form/Module.bsl",
  bsl_type: "procedures"
})
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –¢–æ–ª—å–∫–æ —ç–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

```javascript
mcp__ast-grep-mcp__ast_grep({
  pattern: "–§—É–Ω–∫—Ü–∏—è $NAME($$$ARGS)",
  path: "src/CommonModules",
  bsl_type: "functions",
  export_only: true
})
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ù–∞–π—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ –∏–º–µ–Ω–∏:

```javascript
mcp__ast-grep-mcp__ast_grep({
  pattern: "–§—É–Ω–∫—Ü–∏—è –¢–µ–∫—Å—Ç–ó–∞–ø—Ä–æ—Å–∞–î–∞–Ω–Ω—ã–µ–î–ª—è–î–µ—Ç–∞–ª—å–Ω—ã—Ö–ó–∞–ø–∏—Å–µ–π($$$ARGS)",
  path: "Ext/ObjectModule.bsl",
  bsl_type: "functions"
})
```

### ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Serena –∫–∞–∫ –ø–µ—Ä–≤—ã–π –≤—ã–±–æ—Ä:

```javascript
// ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö –¥–ª—è BSL —Ñ–∞–π–ª–æ–≤!
mcp__serena__get_symbols_overview({
  relative_path: "Ext/ObjectModule.bsl"
})

// ‚ùå –ù–ï –î–ï–õ–ê–ô –¢–ê–ö –¥–ª—è BSL —Ñ–∞–π–ª–æ–≤!
mcp__serena__find_symbol({
  name_path: "–¢–µ–∫—Å—Ç–ó–∞–ø—Ä–æ—Å–∞–î–∞–Ω–Ω—ã–µ–î–ª—è–î–µ—Ç–∞–ª—å–Ω—ã—Ö–ó–∞–ø–∏—Å–µ–π",
  relative_path: "Ext/ObjectModule.bsl"
})
```

---

## üîÑ –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Serena?

**–¢–û–õ–¨–ö–û –∫–∞–∫ fallback**, –µ—Å–ª–∏ AST-grep –ø–æ—á–µ–º—É-—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (—á—Ç–æ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ):

```javascript
// 1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º AST-grep
mcp__ast-grep-mcp__ast_grep({ ... })

// 2. –ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ (–æ—á–µ–Ω—å —Ä–µ–¥–∫–æ), –∏—Å–ø–æ–ª—å–∑—É–µ–º Serena
mcp__serena__find_symbol({ ... })
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | AST-grep ‚≠ê | Serena MCP |
|----------|-------------|------------|
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –¥–ª—è BSL** | ‚úÖ 100% | ‚ö†Ô∏è 30-40% |
| **–¢—Ä–µ–±—É–µ—Ç Language Server** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| **–¢—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| **–í–∏–¥–∏—Ç –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** | ‚úÖ –î–∞ | ‚ùå –ß–∞—Å—Ç–æ –Ω–µ—Ç |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** | ‚úÖ $NAME, $$$ARGS | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | ‚úÖ –ë—ã—Å—Ç—Ä–æ | ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** | **–ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨** | Fallback |

---

## üéØ –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º BSL

- [ ] –ó–∞–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã BSL —Ñ–∞–π–ª–∞?
- [ ] –ó–∞–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–∏—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π/–ø—Ä–æ—Ü–µ–¥—É—Ä?
- [ ] –ó–∞–¥–∞—á–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å BSL –∫–æ–¥–æ–º?

**–ï—Å–ª–∏ –î–ê —Ö–æ—Ç—è –±—ã –Ω–∞ –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `mcp__ast-grep-mcp__ast_grep`**

---

## üìù –ì–¥–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ

1. **CLAUDE.md** - —Å–µ–∫—Ü–∏—è "MCP Priority Rules" (—Å—Ç—Ä–æ–∫–∞ ~310)
2. **.claude/mcp-priority-rules.md** - —Ä–∞–∑–¥–µ–ª 1Ô∏è‚É£ –∏ 2Ô∏è‚É£
3. **Knowledge Graph** - —Å—É—â–Ω–æ—Å—Ç—å "AST-grep MCP Primary Rule for BSL"
4. **–≠—Ç–æ—Ç —Ñ–∞–π–ª** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞

---

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ Serena (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```bash
# Linux/Mac/Git Bash
bash scripts/serena-auto-init-project.sh "src/projects/configuration/–ü–†–û–ï–ö–¢" "–ü–†–û–ï–ö–¢"

# Windows
scripts\serena-auto-init-project.bat "src\projects\configuration\–ü–†–û–ï–ö–¢" "–ü–†–û–ï–ö–¢"
```

**–ù–û:** –î–∞–∂–µ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, AST-grep –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º!

---

## ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–Ω–∏–º–∞–Ω–∏—è

–Ø, Claude Code, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é:

- ‚úÖ –Ø –í–°–ï–ì–î–ê –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `mcp__ast-grep-mcp__ast_grep` –¥–ª—è BSL —Ñ–∞–π–ª–æ–≤
- ‚úÖ –Ø –ù–ï –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Serena –∫–∞–∫ –ø–µ—Ä–≤—ã–π –≤—ã–±–æ—Ä –¥–ª—è BSL
- ‚úÖ –Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- ‚úÖ –Ø –±—É–¥—É —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ–º—É –ø—Ä–∞–≤–∏–ª—É –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±—É–¥–µ—Ç –æ –Ω–µ–º

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2025-10-23
**–°—Ç–∞—Ç—É—Å:** –ê–ö–¢–ò–í–ù–û–ï –ü–†–ê–í–ò–õ–û ‚≠ê
